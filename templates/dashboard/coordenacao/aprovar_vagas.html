{% extends "dashboard/base_dashboard.html" %}
{% load django_tables2 %}
{% load static %}

{% block titulo %}Aprovar Vagas{% endblock %}

{% block conteudo %}

<h2 class="title-dashboard mb-4">
    <i class="bi bi-clipboard-check me-2"></i>
    Aprovar Vagas
</h2>

{% if table.page.object_list %}
<div class="table-container">
    {% render_table table %}
</div>

<!-- ========================
     MODAIS — APROVAR & REPROVAR
========================= -->
{% for row in table.page.object_list %}
{% with vaga=row.record %}

<!-- MODAL APROVAR -->
<div id="aprovar-{{ vaga.id }}" class="modal-vaga">
    <div class="modal-content-vaga">

        <a href="#" class="modal-close"><i class="bi bi-x-lg"></i></a>

        <h3 class="fw-bold mb-3">Aprovar Vaga</h3>

        <p class="text-muted">
            Deseja realmente aprovar a vaga
            <strong>{{ vaga.titulo }}</strong> da empresa
            <strong>{{ vaga.empresa.nome|default:vaga.empresa.email }}</strong>?
        </p>

        <div class="d-flex gap-3 mt-4">
            <a href="{% url 'dashboard:aprovar_vaga_action' vaga.id %}" 
               class="modal-btn-apply">
                Aprovar vaga
            </a>

            <a href="#" class="modal-btn-apply"
               style="background: var(--gray-300); color: var(--gray-800); box-shadow:none;">
                Cancelar
            </a>
        </div>

    </div>
</div>

<!-- MODAL REPROVAR -->
<div id="reprovar-{{ vaga.id }}" class="modal-vaga">
    <div class="modal-content-vaga">

        <a href="#" class="modal-close"><i class="bi bi-x-lg"></i></a>

        <h3 class="fw-bold mb-3 text-danger">Reprovar Vaga</h3>

        <p class="text-muted">
            Tem certeza que deseja <strong>reprovar</strong> a vaga
            <strong>{{ vaga.titulo }}</strong>?
        </p>

        <div class="d-flex gap-3 mt-4">
            <a href="{% url 'dashboard:reprovar_vaga_action' vaga.id %}" 
               class="modal-btn-apply" style="background:#c53030;">
                Reprovar
            </a>

            <a href="#" class="modal-btn-apply"
               style="background: var(--gray-300); color: var(--gray-800); box-shadow:none;">
                Cancelar
            </a>
        </div>

    </div>
</div>

{% endwith %}
{% endfor %}

{% else %}

<div class="empty-state-wrapper d-flex align-items-center justify-content-center gap-4 py-5">

    <img src="{% static 'assets/img/empty.svg' %}" 
         class="empty-img"
         style="width:420px">

    <div class="empty-state-text" style="max-width:380px;">
        <h5 class="fw-bold mb-2">Nenhuma vaga aguardando aprovação</h5>
        <p class="text-muted m-0">
            Assim que novas vagas forem criadas, aparecerão aqui.
        </p>
    </div>

</div>

{% endif %}

{% endblock %}
