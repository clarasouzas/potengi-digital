{% extends "dashboard/base_dashboard.html" %}
{% load static %}

{% block conteudo %}

<!-- HERO DO PAINEL -->
<div class="hero-dashboard rail-bleed mb-4">

  <div class="hero-text">
    <small class="hero-hello">Olá, {{ user.nome|default:user.email }}</small>
    <h3 class="hero-title">Gerencie suas vagas com facilidade</h3>
    <p class="hero-subtitle">Acompanhe o status das vagas e visualize as mais recentes.</p>
  </div>

  <div class="hero-illustration">
    <img src="{% static 'assets/img/hero-em-dash.svg' %}" alt="Dashboard Empresa — LinkIF">
  </div>

</div>


<div class="dashboard-wrapper">

  <h2 class="title-dashboard mb-4">Visão Geral</h2>


  <!-- AVISO DE STATUS DE APROVAÇÃO -->
{% if request.user.status_aprovacao == "pendente" %}
<div class="approval-box shadow-sm">
    <i class="bi bi-hourglass-split"></i>
    <div>
        Seu perfil está <b>em análise pela coordenação</b>.<br>
        Assim que aprovado, todos os recursos serão desbloqueados.
    </div>
</div>

{% elif request.user.status_aprovacao == "reprovado" %}
<div class="reproval-box shadow-sm" >
    <i class="bi bi-x-circle"></i>
    <div>
        Seu cadastro foi <b>reprovado pela coordenação</b>.<br>
        O acesso às funcionalidades permanece bloqueado.<br>
        Caso necessário, entre em contato com o suporte.
    </div>
</div>
{% endif %}



  {% if request.user.is_approved %}

  <!-- MÉTRICAS -->
  <div class="row g-4 mb-4">

      <div class="col-md-4">
          <div class="metric-card">
              <div class="metric-icon"><i class="bi bi-briefcase-fill"></i></div>
              <div>
                  <h3>{{ total_vagas }}</h3>
                  <p>Vagas cadastradas</p>
              </div>
          </div>
      </div>

      <div class="col-md-4">
          <div class="metric-card">
              <div class="metric-icon"><i class="bi bi-clock-history"></i></div>
              <div>
                  <h3>{{ vagas_pendentes }}</h3>
                  <p>Aguardando aprovação</p>
              </div>
          </div>
      </div>

      <div class="col-md-4">
          <div class="metric-card">
              <div class="metric-icon"><i class="bi bi-people-fill"></i></div>
              <div>
                  <h3>{{ total_candidaturas }}</h3>
                  <p>Candidaturas recebidas</p>
              </div>
          </div>
      </div>

  </div>



  <!-- ÚLTIMAS VAGAS CADASTRADAS (AGORA NO ESTILO ALUNA) -->
  <div class="section-card mb-4">

      <h5 class="section-title">
          <i class="bi bi-briefcase me-1"></i>
          Suas últimas vagas cadastradas
      </h5>

      {% if vagas_recentes %}
      <ul class="list-group list-group-flush">

          {% for vaga in vagas_recentes %}
          <li class="list-group-item d-flex justify-content-between align-items-center">

              <div>
                  <strong>{{ vaga.titulo }}</strong><br>

                  <small class="text-muted">
                      {{ vaga.get_status_display }} — {{ vaga.data_publicacao|date:"d/m/Y" }}
                  </small>

                  <p class="text-muted small mt-1 mb-0">
                      {{ vaga.descricao|truncatewords:20 }}
                  </p>
              </div>

    

          </li>
          {% endfor %}

      </ul>
        {% else %}
        <div class="empty-state-wrapper d-flex align-items-center gap-3 py-4">

            <!-- ILUSTRAÇÃO -->
            <div class="empty-state-image">
                <img src="{% static 'assets/img/empty.svg' %}" alt="Nenhuma vaga cadastrada" class="empty-img">
            </div>

            <!-- TEXTO -->
            <div class="empty-state-text">
                <h5 class="fw-bold mb-1">Ops, parece que você ainda não cadastrou nenhuma vaga!</h5>
                <p class="text-muted m-0">
                    Crie sua primeira vaga para começar a receber candidaturas.
                </p>
            </div>

    </div>
    {% endif %}


  </div>

  {% endif %}

</div>

{% endblock %}
