{% extends "dashboard/base_dashboard.html" %}
{% load static %}

{% block titulo %}Minhas Vagas{% endblock %}

{% block conteudo %}

<h2 class="title-dashboard mb-4">
    <i class="bi bi-briefcase me-2"></i>Minhas Vagas
</h2>

{% if vagas %}

<div class="row g-3">

    {% for vaga in vagas %}
    <div class="col-12 col-md-6 col-lg-4">

        <div class="card-list">

            <!-- Título -->
            <div class="card-title">{{ vaga.titulo }}</div>

            <!-- Empresa -->
            <div class="card-meta">
                <i class="bi bi-building me-1"></i>
                {{ vaga.empresa.nome }}
            </div>

            <!-- Cidade -->
            <div class="card-meta">
                <i class="bi bi-geo-alt me-1"></i>
                {{ vaga.cidade|default:"Cidade não informada" }}
            </div>

            <!-- Status -->
            <div class="mt-2">
                {% if vaga.status == "pendente" %}
                    <span class="badge pend"><i class="bi bi-hourglass-split me-1"></i>Pendente</span>

                {% elif vaga.status == "aprovada" %}
                    <span class="badge aprov"><i class="bi bi-check2-circle me-1"></i>Aprovada</span>

                {% elif vaga.status == "reprovada" %}
                    <span class="badge recs"><i class="bi bi-x-circle me-1"></i>Reprovada</span>

                {% elif vaga.status == "encerrada" %}
                    <span class="badge anls"><i class="bi bi-slash-circle me-1"></i>Encerrada</span>
                {% endif %}
            </div>

            <!-- AÇÕES -->
            <div class="card-actions">

                <!-- abrir modal -->
                <a href="#modal-vaga-{{ vaga.id }}" class="btn-outline-action">
                    <i class="bi bi-eye"></i> Ver
                </a>

                <a href="{% url 'dashboard:empresa_editar_vaga' vaga.id %}"
                   class="btn-outline-action">
                    <i class="bi bi-pencil"></i> Editar
                </a>

                <a href="{% url 'dashboard:empresa_excluir_vaga' vaga.id %}"
                   class="btn-outline-action">
                    <i class="bi bi-trash"></i> Excluir
                </a>

            </div>

        </div>
    </div>


    <!-- =====================================================
         MODAL — MESMA ESTRUTURA DA PÁGINA DE CANDIDATURAS
    ====================================================== -->
    <div id="modal-vaga-{{ vaga.id }}" class="modal-vaga">

        <div class="modal-content-vaga">

            <a href="#" class="modal-close"><i class="bi bi-x-lg"></i></a>

            <h3 class="title-section fw-bold">{{ vaga.titulo }}</h3>

            <div class="modal-badges">

                <span class="tag-chip">
                    <i class="bi bi-buildings"></i> {{ vaga.empresa.nome|upper }}
                </span>

                <span class="tag-chip">
                    <i class="bi bi-geo-alt"></i> {{ vaga.cidade|default:"-" }}/RN
                </span>

                <span class="tag-chip">
                    <i class="bi bi-briefcase"></i> {{ vaga.get_tipo_display }}
                </span>

                {% if vaga.remuneracao %}
                <span class="tag-chip">
                    <i class="bi bi-cash"></i> R$ {{ vaga.remuneracao }}
                </span>
                {% endif %}

            </div>

            <hr>

            <h5 class="title-section">Descrição</h5>
            <p>{{ vaga.descricao|default:"Sem descrição informada." }}</p>

            {% if vaga.requisitos %}
            <h5 class="title-section">Requisitos</h5>
            <p>{{ vaga.requisitos }}</p>
            {% endif %}

            {% if vaga.data_publicacao %}
            <span class="modal-date-chip">
                Publicada em {{ vaga.data_publicacao|date:"d/m/Y" }}
            </span>
            {% endif %}

        </div>

    </div>
    <!-- fim modal -->

    {% endfor %}

</div>

{% else %}

<div class="empty-state-wrapper py-5"
     style="
        display:flex;
        align-items:center;
        justify-content:center;
        gap:32px;
        text-align:left;
     ">

    <!-- IMAGEM GRANDE -->
    <img src="{% static 'assets/img/empty.svg' %}"
         alt="Nenhuma candidatura recebida"
         class="empty-img"
         style="width: 340px; height:auto; flex-shrink:0;">

    <!-- TEXTO -->
    <div class="empty-state-text">
        <h5 class="fw-bold mb-2">Você ainda não cadastrou nenhuma vaga</h5>

        <p class="text-muted m-0" style="max-width:480px;">
            Adicione sua primeira vaga para começar a receber candidaturas dos alunos.
        </p>
    </div>

</div>
{% endif %}

{% endblock %}
