{% extends "base.html" %}
{% load static %}

{% block title %}Vagas ‚Äî LinkIF{% endblock %}

{% block content %}

<!-- HERO -->
<section class="hero hero-estudante">
  <div class="container text-center text-md-start">
    <div class="row align-items-center">
      <div class="col-md-7">
        <h1>Conecte-se √†s melhores oportunidades üíº</h1>
        <p>
          Explore vagas de est√°gio, emprego e bolsa voltadas para estudantes do IFRN.  
          D√™ o primeiro passo na sua carreira com o <strong>LinkIF</strong>!
        </p>
        <div class="botoes">
          <a href="{% url 'usuarios:login' %}" class="botao-principal">
            <i class="bi bi-person-check"></i> Entrar para se candidatar
          </a>
          <a href="{% url 'usuarios:cadastro' %}" class="botao-secundario ms-2">
            <i class="bi bi-person-plus"></i> Criar conta
          </a>
        </div>
      </div>
      <div class="hero-art">
        <img src="{% static 'assets/img/estudante.png' %}" alt="Estudantes" class="hero-art">
      </div>
    </div>
  </div>
</section>


<!-- LISTAGEM DE VAGAS -->
<section class="vagas-section py-5">
  <div class="container">
    <h2 class="fw-bold text-center mb-4" style="color:#1b1f5b;">
      Encontre a vaga ideal para o seu futuro profissional
    </h2>

    <div class="row g-4">
      <!-- FILTRO -->
      <div class="col-lg-3">
        <div class="filtro-card p-4 rounded shadow-sm bg-white">
          <h6 class="fw-bold mb-3" style="color:#0F0261;">Personalize sua pesquisa</h6>

          <form method="get">
            <div class="mb-3">
              <label class="form-label fw-semibold">Nome da vaga</label>
              <input type="text" name="titulo" class="form-control" placeholder="Ex: Desenvolvedor" value="{{ request.GET.titulo }}">
            </div>

            <div class="mb-3">
              <label class="form-label fw-semibold">Localiza√ß√£o</label>
              <input type="text" name="cidade" class="form-control" placeholder="Cidade ou estado" value="{{ request.GET.cidade }}">
            </div>

            <div class="mb-3">
              <label class="form-label fw-semibold">Tipo de vaga</label>
              <select name="tipo" class="form-select">
                <option value="">Todos os tipos</option>
                {% for key, value in vagas.model.TIPO_CHOICES %}
                  <option value="{{ key }}" {% if request.GET.tipo == key %}selected{% endif %}>{{ value }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="mb-4">
              <label class="form-label fw-semibold">√Årea de atua√ß√£o</label>
              <select name="area" class="form-select">
                <option value="">Todas as √°reas</option>
                {% for area in areas %}
                  <option value="{{ area.nome }}" {% if request.GET.area == area.nome %}selected{% endif %}>{{ area.nome }}</option>
                {% endfor %}
              </select>
            </div>

            <button type="submit" class="btn w-100 text-white fw-semibold" style="background-color:#205072;">Filtrar</button>
          </form>
        </div>
      </div>

      <!-- RESULTADOS -->
      <div class="col-lg-9">
        <div class="row g-4">
          {% for vaga in vagas %}
          <div class="col-md-4 d-flex">
            <div class="card border-0 shadow-sm rounded-4 p-3 w-100 vaga-card d-flex flex-column">
              <div class="vaga-status-container d-flex justify-content-between align-items-center mb-1">
                <span class="vaga-status text-success">
                  {% if vaga.status == "aprovada" %}Dispon√≠vel{% else %}{{ vaga.get_status_display }}{% endif %}
                </span>
                <small class="text-muted">{{ vaga.empresa.nome_empresa }}</small>
              </div>

              <h6 class="fw-bold mt-1" style="color:#1b1f5b;">{{ vaga.titulo }}</h6>
              <p class="text-secondary mb-1"><i class="bi bi-geo-alt-fill"></i> {{ vaga.cidade }}{% if vaga.estado %}/{{ vaga.estado }}{% endif %}</p>
              <p class="text-secondary mb-1"><i class="bi bi-briefcase-fill"></i> {{ vaga.get_tipo_display }}</p>

              {% if vaga.area %}
                <p class="text-secondary mb-1"><i class="bi bi-tag-fill"></i> {{ vaga.area.nome }}</p>
              {% endif %}

              {% if vaga.remuneracao %}
                <p class="fw-bold" style="color:#0F0261;">R$ {{ vaga.remuneracao|floatformat:2 }}</p>
              {% endif %}

              <a href="{% url 'linkif:detalhar_vaga' vaga.id %}" class="btn fw-semibold text-white mt-auto" style="background-color:#205072;">
                Quero esta vaga
              </a>
            </div>
          </div>
          {% empty %}
          <div class="text-center mt-4">
            <p class="text-secondary">Nenhuma vaga encontrada com os filtros selecionados.</p>
            <img src="{% static 'assets/img/sem_vagas.svg' %}" alt="Sem vagas" class="img-fluid mt-3" style="max-width:240px;">
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>

{% endblock %}
