{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="container mt-5 pt-5">

    <!-- CARD PRINCIPAL -->
    <div class="card shadow-lg border-0 rounded-4 overflow-hidden">

        <!-- ====================== TOPO COM COR DINÂMICA ====================== -->
        <div 
            class="p-5 text-center text-white 
            {% if aluno.curso == 'Meio Ambiente' %} bg-success
            {% elif aluno.curso == 'Edificações' %} bg-warning
            {% elif aluno.curso == 'InfoWeb' %} bg-primary
            {% else %} bg-dark
            {% endif %}"
            
            {% if aluno.curso == 'Licenciatura em Matemática' %}
                style="background-color: #6f42c1;"
            {% endif %}
        >

            <!-- FOTO DE PERFIL -->
            {% if aluno.foto %}
                <img src="{{ aluno.foto.url }}" 
                     class="rounded-circle mx-auto d-block shadow"
                     style="width: 120px; height: 120px; object-fit: cover;">
            {% else %}
                <img src="{% static 'img/user-default.webp' %}" 
                     class="rounded-circle mx-auto d-block shadow"
                     style="width: 120px; height: 120px; object-fit: cover;">
            {% endif %}

            <h2 class="mt-3 fw-bold">
                {{ aluno.usuario.first_name|default:"Não informado" }}
                {{ aluno.usuario.last_name|default:"" }}
            </h2>

            <p class="opacity-75">
                Estudante • {{ aluno.curso|default:"Não informado" }}
            </p>

        </div>

        <!-- ====================== ÁREA INFERIOR ====================== -->
        <div class="p-4" style="background: #f1f3f5;">

            <div class="row">

                <!-- Nome Completo -->
                <h6 class="text-muted text-uppercase">Nome Completo</h6>
                <p class="fw-semibold">
                    {{ aluno.usuario.first_name|default:"Não informado" }}
                    {{ aluno.usuario.last_name|default:"" }}
                </p>

                <!-- Email -->
                <div class="col-md-6 mb-3">
                    <h6 class="text-muted text-uppercase">Email</h6>
                    <p class="fw-semibold">{{ aluno.usuario.email|default:"Não informado" }}</p>
                </div>

                <!-- Telefone -->
                <div class="col-md-6 mb-3">
                    <h6 class="text-muted text-uppercase">Telefone</h6>
                    <p class="fw-semibold">{{ aluno.usuario.telefone|default:"Não informado" }}</p>
                </div>

                <!-- Curso -->
                <div class="col-md-6 mb-3">
                    <h6 class="text-muted text-uppercase">Curso</h6>
                    <p class="fw-semibold">{{ aluno.curso|default:"Não informado" }}</p>
                </div>

                <!-- Ano de Conclusão -->
                <div class="col-md-6 mb-3">
                    <h6 class="text-muted text-uppercase">Ano de Conclusão</h6>
                    <p class="fw-semibold">{{ aluno.usuario.anodeconclusao|default:"Não informado" }}</p>
                </div>

                <!-- Portfólio -->
                <div class="col-md-12 mb-3">
                    <h6 class="text-muted text-uppercase">Portfólio</h6>

                    {% if aluno.usuario.portifolio %}
                        <p class="fw-semibold">
                            <a href="{{ aluno.usuario.portifolio }}" 
                               target="_blank" 
                               class="fw-bold text-primary">
                                {{ aluno.usuario.portifolio }}
                            </a>
                        </p>
                    {% else %}
                        <p class="text-muted">Não informado</p>
                    {% endif %}
                </div>

            </div>

        </div>

    </div>

    <!-- ====================== BOTÕES LADO A LADO ====================== -->
    <div class="d-flex justify-content-center gap-3 mt-4">

        <!-- Editar -->
        <a href="{% url 'usuarios:editar_perfil_aluno' %}" 
           class="btn btn-primary px-4 py-2"
           style="border-radius: 50px; font-size: 16px;">
           Editar Perfil
        </a>

        <!-- Excluir (abre modal) -->
        <button class="btn btn-danger px-4 py-2"
                style="border-radius: 50px; font-size: 16px;"
                data-bs-toggle="modal" 
                data-bs-target="#modalExcluirConta">
            Excluir Conta
        </button>
    </div>

</div>


<!-- ====================== MODAL DE CONFIRMAÇÃO ====================== -->
<div class="modal fade" id="modalExcluirConta" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content shadow-lg rounded-4">

            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">Excluir Conta</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body text-center">
                <h5>Tem certeza que deseja excluir sua conta?</h5>
                <p class="text-muted">Esta ação não pode ser desfeita.</p>
            </div>

            <div class="modal-footer d-flex justify-content-center">

                <form method="POST" action="{% url 'usuarios:excluir_perfil' %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Excluir</button>
                </form>

                <button class="btn btn-secondary" data-bs-dismiss="modal">
                    Cancelar
                </button>

            </div>

        </div>
    </div>
</div>


{% endblock %}
